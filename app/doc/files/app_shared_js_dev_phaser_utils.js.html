<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>app\shared\js\dev\phaser\utils.js - LREditor API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="LREditor API"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Behaviour.Button.html">Behaviour.Button</a></li>
                                <li><a href="../classes/Behaviour.LR.Editor.Behaviour.ScrollerVertical.html">Behaviour.LR.Editor.Behaviour.ScrollerVertical</a></li>
                                <li><a href="../classes/Behaviour.ScrollerHorizontal.html">Behaviour.ScrollerHorizontal</a></li>
                                <li><a href="../classes/Behaviour.Trigger.html">Behaviour.Trigger</a></li>
                                <li><a href="../classes/Behaviour.TriggerChangeLevel.html">Behaviour.TriggerChangeLevel</a></li>
                                <li><a href="../classes/Behaviour.TriggerCutscene.html">Behaviour.TriggerCutscene</a></li>
                                <li><a href="../classes/Editor.LevelImporterEditor.html">Editor.LevelImporterEditor</a></li>
                                <li><a href="../classes/Entity.BitmapText.html">Entity.BitmapText</a></li>
                                <li><a href="../classes/Entity.Button.html">Entity.Button</a></li>
                                <li><a href="../classes/Entity.Sprite.html">Entity.Sprite</a></li>
                                <li><a href="../classes/Entity.Text.html">Entity.Text</a></li>
                                <li><a href="../classes/Entity.TileSprite.html">Entity.TileSprite</a></li>
                                <li><a href="../classes/LR.Behaviour.html">LR.Behaviour</a></li>
                                <li><a href="../classes/LR.Body.html">LR.Body</a></li>
                                <li><a href="../classes/LR.CollisionManager.html">LR.CollisionManager</a></li>
                                <li><a href="../classes/LR.Game.html">LR.Game</a></li>
                                <li><a href="../classes/LR.GameObject.html">LR.GameObject</a></li>
                                <li><a href="../classes/LR.LevelExporter.html">LR.LevelExporter</a></li>
                                <li><a href="../classes/LR.LevelImporter.html">LR.LevelImporter</a></li>
                                <li><a href="../classes/LR.LevelImporterGame.html">LR.LevelImporterGame</a></li>
                                <li><a href="../classes/LR.LevelUtilities.html">LR.LevelUtilities</a></li>
                                <li><a href="../classes/LR.LR.html">LR.LR</a></li>
                                <li><a href="../classes/LR.State.html">LR.State</a></li>
                                <li><a href="../classes/LR.Utils.html">LR.Utils</a></li>
                                <li><a href="../classes/Misc.TriggerMessageObject.html">Misc.TriggerMessageObject</a></li>
                                <li><a href="../classes/Phaser.Plugin..Pollinator.html">Phaser.Plugin..Pollinator</a></li>
                                <li><a href="../classes/Phaser.Plugin.CutsceneManager.html">Phaser.Plugin.CutsceneManager</a></li>
                                <li><a href="../classes/Phaser.Plugin.DialogManager.html">Phaser.Plugin.DialogManager</a></li>
                                <li><a href="../classes/Phaser.Plugin.InputManager.html">Phaser.Plugin.InputManager</a></li>
                                <li><a href="../classes/Phaser.Plugin.PlayerSave.html">Phaser.Plugin.PlayerSave</a></li>
                                <li><a href="../classes/UI.DialogBox.html">UI.DialogBox</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: app\shared\js\dev\phaser\utils.js</h1>
                        
                        <div class="file">
                            <pre class="code prettyprint linenums">
                        &quot;use strict&quot;;
                        /**
                        * Misc Utilities
                        *
                        * @namespace LR
                        * @class Utils
                        * @constructor
                        */
                        LR.Utils = function(){
                        
                        }
                        
                        LR.Utils.RIGHT = &quot;right&quot;;
                        LR.Utils.LEFT = &quot;left&quot;;
                        LR.Utils.TOP = &quot;top&quot;;
                        LR.Utils.BOTTOM = &quot;bottom&quot;;
                        
                        /**
                        * Remove an object from the specified array and return it
                        *
                        * @namespace LR
                        * @method removeFromArray
                        * @param {Object} object Object to be removed
                        * @param {Array} array The array containing the object
                        * @return null if not found
                        */
                        LR.Utils.RemoveFromArray = function(_object,_array){
                        	var found = false;
                        	var i;
                        	for( i=0; i &lt; _array.length; i++){
                        		//if the callback &amp; context are the same
                        		if( _array[i] === _object ){
                        			//this is the object we are looking for
                        			found = true;
                        			break;
                        		}
                        	}
                        	if( found ){
                        		var objectRemoved = _array[i];
                        		_array.splice(i,1);
                        		return objectRemoved;
                        	}
                        	return null;
                        }
                        
                        /**
                        * Converts from degrees to radians.
                        *
                        * @method toRadians
                        * @param {Number} angle in degrees
                        */
                        LR.Utils.toRadians = function(_degrees) {
                          return _degrees * Math.PI / 180;
                        };
                         
                        /**
                        * Converts from radians to degrees.
                        *
                        * @method toDegrees
                        * @param {Number} angle in radians
                        */
                        LR.Utils.toDegrees = function(_radians) {
                          return _radians * 180 / Math.PI;
                        };
                        
                        /**
                        * Rotates a point with the given angle (in degrees)
                        *
                        * @method rotatePoint
                        * @param {Phaser.Point} point If null, default value is (1,0)
                        * @param {Number} angle In degrees. Positive angle go counter-clokwise
                        * @return Phaser.Point
                        */
                        LR.Utils.rotatePoint = function(_point,_angle){
                        	if( _point == null ) _point = new Phaser.Point(1,0);
                        	_angle = _angle * Math.PI / 180;
                           var point= new Phaser.Point();
                           point.x = _point.x*Math.cos(_angle) - _point.y*Math.sin(_angle);
                           point.y = _point.x*Math.sin(_angle) + _point.y*Math.cos(_angle);
                           return point;
                        }
                        
                        /**
                        * Rotates a point with the given angle (in degrees) around the specified anchor point
                        *
                        * @method rotatePointAround
                        * @param {Phaser.Point} point
                        * @param {Number} angle In degrees. Positive angle go counter-clokwise
                        * @param {Phaser.Point} anchor The anchor point to rotate around
                        * @return Phaser.Point
                        */
                        LR.Utils.rotatePointAround = function(_point,_angle,_anchor){
                        	_angle = _angle * Math.PI / 180;
                           //translate the point to rotate it around origin (0,0)
                           var tPoint= new Phaser.Point(_point.x - _anchor.x, _point.y - _anchor.y);
                           var newPoint = new Phaser.Point();
                           newPoint.x = tPoint.x*Math.cos(_angle) - tPoint.y*Math.sin(_angle);
                           newPoint.y = tPoint.x*Math.sin(_angle) + tPoint.y*Math.cos(_angle);
                           //Translate back to the anchor
                           newPoint.x += _anchor.x;
                           newPoint.y += _anchor.y;
                        
                           return newPoint;
                        }
                        
                        /**
                        * Compute angle between two points / vectors
                        *
                        * @method angle
                        * @param {Phaser.Point} pointA
                        * @param {Phaser.Point} pointB
                        */
                        LR.Utils.angle = function(_pointA, _pointB){
                        	var a = _pointA.normalize();
                        	var b = _pointB.normalize();
                        
                        	var dot = a.x * b.x + a.y * b.y;
                        	return Math.acos(dot) * 180 / Math.PI;
                        }
                        
                        
                        /**
                        * This function returns the object&#x27;s property defined by a complex string
                        * ie : if string = &quot;body.x&quot;
                        * the object value will be the body property of the object
                        * If a property is not found, the object is returned as itself
                        * example of returned object :
                        * { object : instanceof P2.Body , property : &quot;x&quot;}
                        * you can then access your property : object[property]
                        */
                        LR.Utils.getPropertyByString = function( _object, _string){
                        	var returnObject = { &quot;object&quot; : _object, &quot;property&quot; : _string};
                        	var arrayProp = _string.split(&#x27;.&#x27;);
                        	if(arrayProp.length &lt; 2)
                        		return returnObject;
                        
                        	var currentProp = _object;
                        	for(var i=0; i &lt; arrayProp.length -1; i++){
                        		if( _object.hasOwnProperty(arrayProp[i])){
                        			currentProp = currentProp[arrayProp[i]];
                        		}else{
                        			return returnObject;
                        		}
                        	}
                        
                        	returnObject.object = currentProp; // the target is the property we found
                        	returnObject.property = arrayProp[arrayProp.length-1]; // the tweened property is the last in the array
                        	
                        	return returnObject;
                        }
                        
                        /**
                        * Returns an object containing the sides of the shapes 
                        * properties of the object : left, right, top, bottom 
                        * in the world coordinates
                        *
                        * @method getRectShapeSides
                        * @param {GameObject} go
                        * @parma {P2.Shape} shape
                        */
                        LR.Utils.getRectShapeSides = function(_go,_shape){
                        	var data = _go.getShapeData(_shape.lr_name);
                        	var p2 = _go.entity.game.physics.p2;
                        
                        	//Rotate shape offset with the body, as offset isnt changed with rotations
                        	var realOffset = new Phaser.Point(data.x,data.y); 
                        	realOffset = LR.Utils.rotatePoint(realOffset, _go.entity.body.angle);
                        	data.x = realOffset.x;
                        	data.y = realOffset.y;
                        
                        	//Compute bounds of the shape
                        	var bounds = new Object();
                        	bounds.left = _go.entity.world.x + p2.mpx(_shape.centerOfMass[0]);
                        	bounds.right = _go.entity.world.x + p2.mpx(_shape.centerOfMass[0]) + p2.mpx(_shape.width)
                        	bounds.top = _go.entity.world.y + p2.mpx(_shape.centerOfMass[1]);
                        	bounds.bottom = _go.entity.world.y + p2.mpx(_shape.centerOfMass[1]) + p2.mpx(_shape.height);
                        
                        	return bounds;
                        }
                        
                        /**
                        * Returns true if the sprite is visible by the camera
                        *
                        * @method isSpriteInCameraView
                        * @param {LR.Entity.Sprite} sprite The sprite
                        * @param {Camera} camera The active camera
                        */
                        LR.Utils.isSpriteInCameraView = function(_sprite,_camera){
                        	var rect = new Phaser.Rectangle(
                        							_sprite.world.x - Math.abs(_sprite.width) * 0.5 ,
                        							_sprite.world.y - Math.abs(_sprite.height) * 0.5, 
                        							Math.abs(_sprite.width),
                        							Math.abs(_sprite.height)
                        				);
                        
                        	var inCam = _camera.view.intersects(rect);
                        	
                        	return inCam;
                        }
                        
                        /**
                        * Returns the side of the collision between two gameobject with a rectangle shape
                        *
                        * @method getRectCollisionSide
                        * @param {LR.GameObject} gameobject1 The first gameobject
                        * @param {Shape} shape1 The first rectangle shape
                        * @param {LR.GameObject} gameobject2 The first gameobject
                        * @param {Shape} shape2 The first rectangle shape
                        */
                        LR.Utils.getRectCollisionSide = function(_go1,_rect1,_go2,_rect2){
                        
                        	var p2 = _go1.game.physics.p2;
                        
                        	var w = 0.5 * p2.mpx(_rect1.width + _rect2.width);
                        	var h = 0.5 * p2.mpx(_rect1.height + _rect2.height);
                        	
                        	var center1 = new Phaser.Point(_go1.entity.world.x + p2.mpx(_rect1.centerOfMass[0]) ,
                        									_go1.entity.world.y + p2.mpx(_rect1.centerOfMass[1]));
                        
                        	var center2 = new Phaser.Point(_go2.entity.world.x + p2.mpx(_rect2.centerOfMass[0]) ,
                        									_go2.entity.world.y + p2.mpx(_rect2.centerOfMass[1]));
                        	var dx = center1.x - center2.x;
                        	var dy = center1.y - center2.y;
                        
                            var wy = w * dy;
                            var hx = h * dx;
                        
                            if (wy &gt; hx){
                                if (wy &gt; -hx){
                                	return LR.Utils.TOP;
                                }else{
                                    return LR.Utils.RIGHT;
                                }
                            }else{
                                if (wy &gt; -hx){
                                	return LR.Utils.LEFT;
                                }else{
                                    return LR.Utils.BOTTOM;
                                }
                            }
                        	return -1;
                        }
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
